# 增加详细分类列表与文档关联功能计划

根据您的需求，我将对现有的 `auto_fill_defects.py` 进行改造，主要增加“明细列表”视图，并实现与原始 Word 文档的关联和实时更新。

## 1. 后端数据采集升级 (Data Extraction)
为了实现“点击打开 Word 文档”，我们需要在数据采集阶段记录数据来源。
*   **修改 `DefectProcessor` 类**：
    *   在读取 Word 表格时，将当前 Word 文档的绝对路径 (`file_path`) 作为附加数据保留。
    *   **扩展 Excel 存储**：将 Excel 的存储列数从 13 列扩展到 14 列，第 14 列用于存储隐藏的“源文件路径”。

## 2. 统计界面重构 (UI Refactoring)
现有的统计界面仅显示图表，我将引入选项卡（Tab）结构来容纳新的功能模块。
*   **引入 `ttk.Notebook`**：
    *   **Tab 1：图表概览** (保留原有功能)：展示柱状图和饼图。
    *   **Tab 2：明细列表** (新增功能)：展示详细的数据表格。

## 3. 明细列表模块实现 (Detail List View)
参考大厂管理后台的设计，实现一个功能丰富的列表视图。
*   **组件**：使用 `ttk.Treeview` 制作多列数据表格。
*   **显示列**：
    *   `状态`：使用图标或颜色区分（✅ 已销号 / 🔴 未销号）。
    *   `设备缺陷地点`、`设备缺陷类型`、`销号时间` 等核心信息。
    *   `操作`：提供“打开文档”的入口。
*   **交互功能**：
    *   **双击打开**：双击列表中的某一行，自动调用系统默认程序（Word）打开对应的原始文档。
    *   **筛选联动**：列表数据将与顶部的“年份/月份”筛选器同步，只显示符合条件的数据。

## 4. 实时统计与刷新机制 (Sync & Refresh)
为了解决“Word 更改后刷新数据”的需求：
*   **新增“同步并刷新”按钮**：
    *   在统计界面增加一个一键同步按钮。
    *   **机制**：点击后，系统会在后台重新扫描并提取 Word 数据（增量或全量），更新 Excel，然后自动刷新界面上的图表和列表。这样您修改了 Word 后，点一下这个按钮，状态就会变为“已销号”。

## 执行步骤
1.  修改数据采集逻辑，增加文件路径记录。
2.  重构 `StatisticsPanel`，添加 Tab 布局。
3.  实现列表视图及双击打开文件功能。
4.  集成“同步并刷新”功能。
